!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Orion=t()}(this,function(){"use strict";var r=Object.assign({login:{method:"POST",path:"sign_in"},logout:{method:"POST",path:"sign_out"},getUserInfo:{method:"GET",path:"user/profile"},setUserInfo:{method:"PUT",path:"user/profile"},setUserGateAuth:{method:"PUT",path:"user/gate_auth"},refreshSecret:{method:"POST",path:"user/refresh_token"},getAllDevicesList:{method:"GET",path:"all_devices"},devicesDelete:{method:"POST",path:"devices/:device_uuid/full_delete"},switchLogTrace:{method:"POST",path:"devices/:device_uuid/switch_log_trace"},syncFeatures:{method:"POST",path:"services/sync_feature",options:{timeout:6e5}},getServiceStatus:{method:"GET",path:"services/status"},getDeviceProfilesList:{method:"GET",path:"device_profiles"},getDeviceProfilesInfo:{method:"GET",path:"device_profiles/:mac_address"},setDeviceProfilesInfo:{method:"PUT",path:"device_profiles/:mac_address"},setDeviceProfilesTemp:{method:"PUT",path:"device_profiles/:mac_address/set_temp"},applyDeviceProfilesTemp:{method:"POST",path:"device_profiles/:mac_address/apply_to"},getDeviceUpgradesList:{method:"GET",path:"device_upgrades"},createDeviceUpgrade:{method:"POST",path:"device_upgrades",options:{timeout:6e5}},getDeviceUpgradeInfo:{method:"GET",path:"device_upgrades/:upgrade_uuid"},resendDeviceUpgrade:{method:"POST",path:"device_upgrades/:upgrade_uuid/send"}},{getAccountInfo:{method:"GET",path:"users/:user_uuid"},getAccountsList:{method:"GET",path:"users"},createAccount:{method:"POST",path:"users"},setAccountInfo:{method:"PUT",path:"users/:user_uuid"},removeAccount:{method:"DELETE",path:"users/:user_uuid"}},{getDevicesList:{method:"GET",path:"devices"},syncDevices:{method:"GET",path:"devices_sync"},bindDevice:{method:"POST",path:"devices"},unbindDevice:{method:"DELETE",path:"devices/:device_uuid"},rebootOrionApp:{method:"POST",path:"devices/:device_uuid/reboot_app"},syncDeviceToBank:{method:"POST",path:"devices/:device_uuid/sync_to_bank"},getDeviceInfo:{method:"GET",path:"devices/:device_uuid"},setDeviceInfo:{method:"PUT",path:"devices/:device_uuid"},setDeviceMode:{method:"POST",path:"devices/:device_uuid/set_mode"},clearDeviceLogs:{method:"POST",path:"devices/:device_uuid/clear_logs"},setDevicePushFliwStatus:{method:"POST",path:"devices/:device_uuid/switch_push_flow"},getPeoplesListFromDevice:{method:"GET",path:"devices/:device_uuid/offline_people"},addPeoplesToDevice:{method:"POST",path:"devices/:device_uuid/add_people",options:{timeout:6e4}},removePeoplesFromDevice:{method:"POST",path:"devices/:device_uuid/remove_people",options:{timeout:6e4}},removeAllPeoplesFromDevice:{method:"POST",path:"devices/:device_uuid/clear"},addAllPeoplesToDevice:{method:"POST",path:"devices/:device_uuid/add_all_people",options:{timeout:6e4}},addDevicePeopleByGroups:{method:"POST",path:"devices/:device_uuid/add_groups",options:{timeout:6e4}},resetDevicePeopleByGroups:{method:"POST",path:"devices/:device_uuid/replace_groups",options:{timeout:6e4}},removeDevicePeopleByGroups:{method:"POST",path:"devices/:device_uuid/remove_groups",options:{timeout:6e4}},addPersonToDevices:{method:"POST",path:"devices_sync_person/:person_uuid/add_to_devices",options:{timeout:6e4}},removePersonFromDevices:{method:"POST",path:"devices_sync_person/:person_uuid/remove_from_devices",options:{timeout:6e4}},resentPersonToDevices:{method:"POST",path:"devices_sync_person/:person_uuid/reset_to_devices",options:{timeout:6e4}},getDeviceBufferList:{method:"GET",path:"devices/:device_uuid/buffer_list"},removeDeviceBuffer:{method:"DELETE",path:"device_buffers/:buffer_uuid"},clearDeviceBuffer:{method:"POST",path:"devices/:device_uuid/buffer_clear"},getDevicesIdentifyRecord:{method:"GET",path:"device_logs/identify_list"},getDevicesStatusRecord:{method:"GET",path:"device_logs/status_list"},captureUploadImage:{method:"POST",path:"device_logs/:mac_address/capture_image"},syncDevicesPersonsImages:{method:"POST",path:"devices/:person_uuid"},recogMode:{method:"POST",path:"iots_switch_mode"},deviceRemoteCtrl:{method:"POST",path:"iots/:device_uuid/remote_ctrl"}},{getGroupInfo:{method:"GET",path:"groups/:group_uuid"},getGroupsList:{method:"GET",path:"groups"},createGroup:{method:"POST",path:"groups"},setGroupInfo:{method:"PUT",path:"groups/:group_uuid"},removeGroup:{method:"DELETE",path:"groups/:group_uuid"},getPeoplesListFromGroup:{method:"GET",path:"groups/:group_uuid/people"},addPeoplesToGroup:{method:"POST",path:"groups/:group_uuid/add_people"},addAllPeoplesToGroup:{method:"POST",path:"groups/:group_uuid/add_all_people"},removePeoplesFromGroup:{method:"POST",path:"groups/:group_uuid/remove_people"},removeAllPeoplesFromGroup:{method:"POST",path:"groups/:group_uuid/clear_people"},addPeoplesToGroupFromOtherGroups:{method:"POST",path:"groups/:group_uuid/add_group"}},{getPersonInfo:{method:"GET",path:"people/:person_uuid"},getPersonsList:{method:"GET",path:"people"},createPerson:{method:"POST",path:"people"},setPersonInfo:{method:"PUT",path:"people/:person_uuid"},removePerson:{method:"DELETE",path:"people/:person_uuid"},addImageToPerson:{method:"POST",path:"people/:person_uuid/add_image",options:{timeout:6e4}},removeImageFromPeople:{method:"POST",path:"people/:person_uuid/remove_image/:image_uuid"},removeAllImageFromPerson:{method:"POST",path:"people/:person_uuid/clear_image"}},{getFaceDetection:{method:"POST",path:"faces/detection",options:{timeout:6e4}},faceVerification:{method:"POST",path:"faces/verification",options:{timeout:6e4}},faceIdentification:{method:"POST",path:"faces/identification",options:{timeout:6e4}},faceImageIdentification:{method:"POST",path:"faces/image_identification",options:{timeout:6e4}},faceIdentifyLogs:{method:"GET",path:"online_identify_logs"},getFaceInfo:{method:"GET",path:"faces/:face_uuid"}},{getQiniuToken:{method:"GET",path:"services/uptoken"},uploadImageToQiniu:{method:"POST",path:"",fullUrl:"https://up.qbox.me",options:{timeout:6e4}}}),e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=function(){function i(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e}}(),g="object"===("undefined"==typeof wx?"undefined":e(wx))&&"function"==typeof wx.request,o=void 0,i="object"===("undefined"==typeof wx?"undefined":e(wx))&&"function"==typeof wx.request;"undefined"!=typeof window&&window.axios?o=window.axios:i||(o=require("axios")),o&&o.interceptors.response.use(function(e){var t=e.headers,o=t["x-total-count"];return isNaN(o-0)||(e.data.total=t["x-total-count"]-0,e.data.page=t["x-current-page"]-0,e.data.per_page=t["x-per-page"]-0),e},function(e){return Promise.reject(e)});var d=o,p="object"===("undefined"==typeof wx?"undefined":e(wx))&&"function"==typeof wx.request,u=void 0,s=function(){function a(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var t=Object.assign({},e),o=t.baseUrl,i=t.token,r=t.AppKey,s=t.AppSecret;if(p||(u=t._axios||d),o&&"string"!=typeof o)throw new Error("解析服务器地址失败，请检查您的服务器地址");o=o||"https://orion.readsense.cn",this.baseUrl=o.replace(/\/$/,""),this.TOKEN=i,this.AppKey=r,this.AppSecret=s}return t(a,[{key:"setToken",value:function(e){if(e&&"string"!=typeof e)throw new Error("解析token失败");this.TOKEN=e}},{key:"setBaseUrl",value:function(e){if(e&&"string"!=typeof e)throw new Error("解析服务器地址失败，请检查您的服务器地址");e=e||"https://orion.readsense.cn",this.baseUrl=e.replace(/\/$/,"")}}]),a}(),a=function(i){Object.hasOwnProperty.call(r,i)&&Object.defineProperty(s.prototype,i,{value:function(e,t){var m,l,f,v,_,o=JSON.parse(JSON.stringify(r[i]));return m=o,l=e,f=t,v={axios:u,baseURL:this.baseUrl,TIMEOUT:this.TIMEOUT||1e4,TOKEN:this.TOKEN,AppKey:this.AppKey,AppSecret:this.AppSecret},_=v.axios,new Promise(function(i,e){var s=Object.assign({},l);for(var t in s)if(Object.hasOwnProperty.call(s,t)){var o=s[t];null!==o&&""!==o||delete s[t]}var r=m.path.match(/:[^/]+/g),a=f||{};r&&r.forEach(function(e){var t=e.replace(":",""),o=m.path;if(a[t])o=o.replace(e,a[t]),m.path=o;else{if(!s[t])throw new Error("参数 "+t+" 不能为空");o=o.replace(e,s[t]),m.path=o,delete s[t]}});var d={method:m.method,timeout:m.TIMEOUT,headers:{}};a&&(d.headers=Object.assign(d.headers,a.headers),delete a.headers);var p=Object.assign({},d,a);s.request_channel="javascript_sdk";var u=v.baseURL;if(p.url=m.fullUrl||u+"/v1/api/"+m.path,"sign_in"!==m.path){var n=v.TOKEN,c=v.AppKey,h=v.AppSecret;if(n)p.headers.Authorization="Bearer "+n;else{if(!c)throw new Error("读取身份信息失败, 请先配置您的AppKey/AppSecret");p.headers.AppKey=c,p.headers.AppSecret=h}}if(g)return p.header=Object.assign({},p.headers),delete p.headers,Object.assign(p,{dataType:"json",success:function(e){var t=e.header,o=t["X-Total-Count"];isNaN(o-0)||(e.data.total=t["X-Total-Count"]-0,e.data.page=t["X-Current-Page"]-0,e.data.per_page=t["X-Per-Page"]-0),i(e)},fail:e}),void("POST"===p.method&&s.image?(p.filePath=s.image,delete s.image,p.name="image",p.formData=s,p.success=i,wx.uploadFile(p)):(p.data=s,wx.request(p)));/post|put/i.test(m.method)?function(){p["Content-Type"]="multipart/form-data";var e=void 0,o=void 0;if("undefined"==typeof FormData){var t=require("form-data");e=!0,o=new t}else o=new FormData;var i=function(t){if(Object.hasOwnProperty.call(s,t))if(/_uuids/.test(t)){var e=s[t];Array.isArray(e)?e.forEach(function(e){return o.append(t+"[]",e)}):o.append(t+"[]",e)}else o.append(t,s[t])};for(var r in s)i(r);if(p.data=o,e)try{d.headers=Object.assign(d.headers,o.getHeaders())}catch(e){}}():/get|delete/i.test(m.method)&&(p.params=s),_(p).then(i).catch(e)})}})};for(var n in r)a(n);return s});
